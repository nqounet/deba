# deba Project Context

あなたは AI エージェント CLI `deba` の開発およびメンテナンスを担当するエンジニアです。

## 技術スタック
- **Runtime**: Node.js (>=20.0.0)
- **Language**: TypeScript
- **Testing**: Vitest
- **Version Management**: GitHub Actions による CI (Node.js 20, 22)

## 設計思想

### 1. プロンプト管理
- 全てのプロンプトは `src/templates/` 配下の Markdown ファイルとして管理されます。
- ソースコード内に大きなプロンプトをインラインで記述してはいけません。
- テンプレート内では `{{VARIABLE}}` 形式のプレースホルダーを使用し、`src/prompt.ts` で動的に値を注入します。
- プロンプトは `# タイトル` から始まり、階層的なセクション構造を持つ必要があります。

### 2. 出力フォーマットの使い分け
- **JSON**: 実装計画 (Phase A) など、機械的にパースして実行エンジンが利用するデータ。
- **YAML**: 振り返り (Reflection)、スキル抽出、知見ベースなど、人間が読み書きし、Markdown（多行テキスト）を含むデータ。

### 3. 隔離実行
- 実装の実行 (`run`, `worker`) は Git Worktree を用いて隔離された環境で行われます。
- 作業中のブランチに直接変更を適用せず、`review` を経てからマージするワークフローを遵守してください。

## 開発ルール
- 機能を変更・追加した際は、必ず `SKILL.md` を更新してください。
- 更新後は `npm run deba -- maintenance setup-skill` を実行して、環境に反映させてください。
- 新しいテンプレートを追加した際は、そのテンプレートの整合性を検証するテストを追加してください。
